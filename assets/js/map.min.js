var currentPopup,center=null,map=null,bounds=null;function addMarker(e,n,o){var a=new google.maps.MarkerImage("assets/img/map_icon.png",new google.maps.Size(32,32),new google.maps.Point(0,0),new google.maps.Point(16,32)),n=new google.maps.LatLng(e,n);(bounds=new google.maps.LatLngBounds).extend(n);var t=new google.maps.Marker({position:n,icon:a,map:map}),p=new google.maps.InfoWindow({content:o,maxWidth:300});google.maps.event.addListener(t,"click",function(){null!=currentPopup&&(currentPopup.close(),currentPopup=null),p.open(map,t),currentPopup=p,jQuery(".gm-style-iw").parent().addClass("infoBox"),jQuery(".infoBox").children("div:first").addClass("hide"),jQuery(".infoBox").parent("div").addClass("parentInfos"),jQuery(".infoBox").find("img").attr("src","assets/img/close-map.png").css("margin","5px")}),google.maps.event.addListener(p,"closeclick",function(){map.panTo(center),currentPopup=null})}function initMap(){map=new google.maps.Map(document.getElementById("map_canvas"),{center:new google.maps.LatLng(0,0),zoom:4,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR},navigationControl:!0,navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}}),jQuery.getJSON("pontos-mapa.php",function(a){jQuery.each(a,function(e,n){var o="<h2>"+a[e].regional+"</h2><span>"+a[e].endereco+"</span><span>"+a[e].complemento+"</span><span>"+a[e].cidade+"/"+a[e].estado+"</span><span>"+a[e].telefone+"</span>";addMarker(a[e].latitude,a[e].longitude,o),bounds.extend(new google.maps.LatLng(a[e].latitude,a[e].longitude))}),center=bounds.getCenter(),map.setCenter(center)})}